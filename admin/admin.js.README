# Admin.js - Complete Implementation

## File Location
/Users/joseph/Documents/Web/admin/admin.js

## Features Implemented

### 1. API Connection
- Connects to API at http://localhost:3001
- Centralized apiRequest() function with error handling

### 2. Works Management
- Load and render all works in a table
- Display: title, date, client, industry, type, featured status, image count
- Edit and Delete buttons for each work

### 3. Search & Filtering
- Text search (searches title, client, info fields)
- Filter by year (dynamic dropdown)
- Filter by industry (dynamic dropdown)
- Filter by type (dynamic dropdown)
- All filters work together

### 4. Add/Edit Modal
- Single modal for both adding and editing works
- All fields supported:
  * title, date, client, industry, contribution
  * style, info, type, videoId, featured
  * Multiple image uploads

### 5. Form Handling
- FormData POST for new works
- FormData PUT for updates
- Featured checkbox sends 'true'/'false' as string
- Multiple file upload support (appends each file)
- Proper field validation and trimming

### 6. Video ID Field
- Toggles visibility based on type selection
- Shows only when type is 'video'
- Clears value when hidden

### 7. Image Previews
- Shows existing images when editing
- Previews new images before upload
- Separates existing vs new images visually
- Handles multiple file selection

### 8. Delete Functionality
- Confirmation dialog before deletion
- Shows work title in confirmation
- Success/error status messages

### 9. Build Function
- Calls /build endpoint via POST
- Confirmation dialog before building
- Button disabled during build
- Shows status messages

### 10. Status Messages
- Three types: info, success, error
- Auto-hide after 5 seconds (success/error)
- Clear, user-friendly messages

### 11. Error Handling
- Try/catch blocks on all async operations
- API error messages displayed to user
- Console logging for debugging
- Graceful degradation

### 12. Security
- HTML escaping for all user content
- Prevents XSS attacks in rendered table

## Key Functions

- initializeEventListeners() - Sets up all event handlers
- apiRequest() - Centralized API communication
- loadWorks() - Fetches all works from API
- renderWorks() - Renders filtered works table
- filterWorks() - Applies all active filters
- openAddModal() / openEditModal() - Modal management
- handleFormSubmit() - Saves work (POST/PUT)
- handleDelete() - Deletes work with confirmation
- handleBuild() - Triggers site build
- toggleVideoIdField() - Shows/hides video ID input
- handleImagePreview() - Previews selected images
- showStatus() - Displays status messages
- escapeHtml() - Sanitizes text output

## Global Exports
- window.openEditModal - For onclick handlers
- window.handleDelete - For onclick handlers

## Backup
Original file backed up to: admin.js.backup
